<!DOCTYPE html>
<html lang="en">

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> of nota </title>

<script src="http://cdnjs.cloudflare.com/ajax/libs/vue/1.0.18/vue.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue-router/0.7.10/vue-router.js"></script>

<link rel="import" name="nota" href="use/components/nota.html">

<main>
  <router-view :data="notae"></router-view>
</main>

<script>
  (function({ window, location, Vue, VueRouter }) {
    
    const $notae = [
      { $folder: '*', title: 'The Silmarillion', content: [ 'duup' , 'lex' ] },
      { $folder: '*', title: '不思議の国のアリス', content: [ 'hely' ] },
      { $folder: '*', title: 'Warning!!', content: [ 'tropic' ] },
      { $folder: 'other', title: 'Don\'t Panic', content: [ 'yuna' ] },
      { $folder: 'other/else', title: 'Sometimes', content: [ 'yuna' ] },
      { $folder: 'other/else/another', title: '1', content: [ 'yuna' ] },
    ]
    
    Vue.config.debug = true
    
    
    let $root = '.'
    if ( location.pathname.slice(1) ) $root = location.pathname

    const router = nota.router = new VueRouter({ history: true, root: $root })
    
    router.map({
      '/': {
        component: nota.components.Nota,
        
        subRoutes: {
          '/*folder': {
            name: 'nota',
            component:  nota.components.NotaList,
          },
          
          '/*folder/:slug': {
            name: 'nota',
            component:  nota.components.NotaList,
          },
        },
      },
    })
    
    router.alias({
      '/': '/*',
    })
    
    router.start({
      data: () => ({
        notae: $notae,
      }),

      name: 'app',
    }, 'main')
    
    window.addEventListener( 'popstate', () => router.replace(location.pathname) )
  })(this)
</script>

</html>